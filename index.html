
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Formulario de Ideas de Mejora</title>
</head>
<body>
  <h2>Enviar Idea de Mejora</h2>
  <form id="mejoraForm">
    <label>Mes: <input type="text" name="mes" required /></label><br>
    <label>Fecha de propuesta: <input type="date" name="fecha" required /></label><br>
    <label>Estatus: <input type="text" name="estatus" required /></label><br>
    <label>Dueño de la mejora: <input type="text" name="dueno" required /></label><br>
    <label>Problema o área de oportunidad:<br><textarea name="problema" required></textarea></label><br>
    <label>Propuesta de mejora:<br><textarea name="propuesta" required></textarea></label><br>
    <label>¿Mejora con ahorro significativo?
      <select name="ahorro">
        <option value="Sí">Sí</option>
        <option value="No">No</option>
      </select>
    </label><br>
    <label>Tipo de mejora: <input type="text" name="tipo" required /></label><br>
    <label>Departamento del dueño de mejora: <input type="text" name="depDueno" required /></label><br>
    <label>Departamento de la mejora: <input type="text" name="depMejora" required /></label><br>
    <label>Línea: <input type="text" name="linea" required /></label><br>
    <label>¿Quién ayudó a implementar?: <input type="text" name="ayuda" /></label><br>
    <label>Mes de cierre de la mejora: <input type="text" name="mesCierre" /></label><br>
    <label>Causa del estatus: <input type="text" name="causa" /></label><br><br>
    <button type="submit">Enviar</button>
  </form>
  <p id="mensaje"></p>

  <script>
    const form = document.getElementById("mejoraForm");
    const mensaje = document.getElementById("mensaje");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = new FormData(form);
      const formObject = {};
      data.forEach((value, key) => formObject[key] = value);

      try {
        const res = await fetch("https://script.google.com/macros/s/AKfycbwxN-_II4vh_DCnajcHDrWZkPSXtOjsESWkEYcVd3_tyZ3OlWbFoJwUSiA5c8UrZEQh/exec", {
          method: "POST",
          body: JSON.stringify(formObject),
          headers: {
            "Content-Type": "application/json"
          }
        });

        const result = await res.text();
        mensaje.textContent = "¡Enviado correctamente!";
        form.reset();
      } catch (error) {
        mensaje.textContent = "Error al enviar. Intenta nuevamente.";
      }
    });
  </script>
</body>
</html>
